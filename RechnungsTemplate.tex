%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%Dieses Dokument benötigt folgende Dateien im selben Ordern:
%%Produkte.csv und Rechnung.csv
%%Trennung
%%Absender.tex, die alle Informationen über den Absender enthält.
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\documentclass[]{scrlttr2}
\KOMAoptions{
firsthead = on,
backaddress=on,
foldmarks=off,
subject = beforeopening
}

\usepackage[ngerman]{babel}
\usepackage{lmodern}


\usepackage{booktabs}
\usepackage{array}
\usepackage{colortbl}
\usepackage{graphics}

\usepackage{array}
\usepackage{tabularx}
\usepackage{pgfplotstable}
\pgfplotsset{compat = newest}

\pgfkeys{/pgf/number format/.cd,fixed,precision=2}
\pgfplotstableset{
precision=2,
column type = r, %alles rechtsbündig aufschreiben
fixed,
 zerofill,
}


\input{Absender.tex}

\begin{document}
\relax

\LoadLetterOption{DIN}
\makeatletter
\@addtoplength{backaddrheight}{-0.5cm}
\@addtoplength{toaddrvpos}{0cm}
\@setplength{toaddrindent}{0.2cm}
\makeatother
\begin{letter}{%
\empfaenger
}

\opening{}

%Tabelle, die Rechnungsposten enthalten soll
\pgfplotstabletypeset[
begin table={\begin{tabularx}{\textwidth}{c X c c c}},
end table={\end{tabularx}},
col sep = space,
read comma as period = true,
columns={Position, Posten, Anzahl, Einzelpreis, Gesamtpreis},
columns/Posten/.style={string type, width=3cm},
columns/Position/.style={precision = 0},
assign column name/.style={
	/pgfplots/table/column name={\textbf{#1}}}
	,
every head row/.style= {
	after row = \toprule},
every last row/.style={
	 after row =\bottomrule}
]{Produkte.csv}

%Tabelle mit Endbeträgen
\raggedleft
\vspace*{2cm}
%\begin{minipage}[t][1.5cm][b]{0.4\textwidth}
\pgfplotstabletypeset[
col sep =&,
columns={bez, betrag},
columns/bez/.style={string type},
columns/betrag/.style={precision = 2},
assign column name/.style={
	/pgfplots/table/column name={\textbf{#1}}}
	,
every head row/.style= {output empty row},
every first row/.style ={
	after row = \toprule},
last head row/.style = {
	int type, precision = 2},
every last row/.style={
	%{\textbf{#1}}
	 after row =\bottomrule}
]{Rechnung.csv}

%\end{minipage}

%Zahlungsmethode

%Fußzeile
\end{letter}
\end{document}